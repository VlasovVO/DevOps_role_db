language: python
python:
- '3.6'
install:
- pip install ansible==2.3.0 molecule apache-libcloud
env:
  matrix:
  - GCE_CREDENTIALS_FILE= "~/.ssh/infra-31376727bcfb.json"
  global:
  - secure: tDT1qRGvP8ooN1kBhr25xKgDdulgX/d9qm24UG6H2OCs3j0MP+7lBvpuNka6uyMCR451YhaU7Yb4EjJGoptxPnHi4IxIs9UMA4Whkh6oSLSjX4bLsAheffCXZ34LngV0rERthLwsvf7tUAUevTpG64IctBq2e0XYGRDdyADDkO6a0g9tXUCzhqTyEAArTphhT0/h7cwvXegy8wPW0cvv58kJxqBzk2HXr53XggVbmZ738IoYPY2cYtECvWWOV4O4eiaEb/82HRG0ph5MBySBaGwmVbWWO750EOtFZbSkS5I7AhQRx6VNQNrZ7L1dL3LLceegyUXmKxn/ite8WH7Svp20FRjIQENVGF7sHJupVdlnp5htjek2M6/LIIC8MvkPZxoLOjY4AXDtHdsWhl72KP5nH28Yi8diu98Q2dbSUOYv42P/oh5So51jsuCFwqbOSEZjNaEYs5u+sNe8nkWHZOfO+PHTsoM5mrdUGL07hb37Hkc3qiqiWXKw+hvH7z8mNbQHVF7gHC8DUEGntw+FESi35WrW/4GwNBdHeOa2BHNVGbihHLXjiS/OKRHwvdRvm4qFagU/9KdId7cbQ/WwzF8DHrI6rCG8B79yJ92E/s6QF84AVX8NOyoFkhCBiV+nU19+DQNfIfDuyBFjLYu8ApA9dw9RKpJgECrTJhMfoiI=
  - secure: wvqAA2RcJTvB5UmZmpHwcEVJD2cdMAAxwcfhCSucst9qsWl7dSwvfaAtzDialzsA5QFB6+b7nqgj75XOGvJ9TUo7PvRhStM+7SbZ1TcS5Rb62ND34xGFGO0ooPnWxcP+4jABGg4T980awhVEdBoU5l6ZCgnIvQ2s13zIb3xw8WXAAuO0zqkQ2Y4679kWsFgCo5+7D27W5hkOUVULZj0bYH0/mePat3s4x+SwKRnSAq/DZu+wjwVUOj/sqym+mvZpXP7hoUN4Oq3mQ4nMa+Wlwqqj1irC81E5Lxia+qxzL7qjnZG9Ohc+AbvdISUdy/SUNU+sNCAFKYs8SUM/fMxo9C7EF8bjFxbFHDlcez//JIOmJfKsotyHZdlq0S7E0ly2CCIWYdl6/QjH90K3OGQXbqLChisr8PXcAk9ElhH8pM1fne5RIgjsCLBgNbAYkiC0LKWZ3gvhfG35XCQNE9JT50WVxHMObQBactfIfkS1Mz0d5R9NT7isXIW4bQlwYWgijQ56COPYyDpiRSU4M14j09uPhTjr5OLIglyII527nzoHWkAy86J8v6bHdYlvwfkVEmj+ageoaSB1pKjxedbQoe5CZ+EOmTkDvwJnEzzdUEnbyvPtpeVHgGJnp5y6TRGqvaOjRf4115beIBFBsO4FW74LNVVrkT7FDSXViTWvQFU=
  - secure: t4lzT/y7Lxkr5V/WDEiEqtPATJAcyL4U/a8Q0aKfixvouUlMvIHS29a8JZkEOT9FdDo51iVX4B4fXTjf+CUeL4wldnB/xJKrI5f1QtAcXFPrgwQGgiVihQwSCj760+sGFQoTkh/F4vnJEtLoNwyci1rIkIcvGewcfgClyO5tELfoFduTtNv1Etmhu1J9Vo9ev/MTdMhFzlzlCX6lP/VY7x1DqaZig7G8SFweuwiqqgvE8LaeU/5kK7bhu+DvcVJ4vlXhviC7emYgaolTWU4BFII0n0bcis+5M+gVIh5gOfpmpEWSXMYcJr2tRN0Ba89pNc6gyRX4ljFgHog1GHocXv22Xh/vemk/hdEbd/xLEfi2WR3L0X+n5xS1WB4orxL7mL5VAVkKySKLdyrzjnz/WvBZjj2eNETd3x+FJA3KhOAMtQaVJQjKXaQZ7VWyaP5+Gl14lJgcjVcQaKc6ALT1YTP8p5F0JxBmvZLsDNFIWQqgjaG+wzIDcrLZYdJAvjDthhhhsMMmGS++XJW4hwV3cFZQaIoO06ov4XUDWrrYgNhxqc7O55vsgz0yfu005YGEs82YKFVR//+PIjGy8uC0SDGobmSCzYdp4RZtVmQqvtzAeNx9AHv19veAbkab1qJO1HG8pNnwmwbToJgWAL8XY5SnbP7KzxeORkJJX2T3cPU=
script:
- molecule create
- molecule converge
- molecule verify
after_script:
- molecule destroy
before_install:
- openssl aes-256-cbc -K $encrypted_a5a5042ef067_key -iv $encrypted_a5a5042ef067_iv
  -in secrets.tar.enc -out secrets.tar -d
- tar xvf secrets.tar
- mv google_compute_engine /home/travis/.ssh/
- chmod 0600 /home/travis/.ssh/google_compute_engine
notifications:
  slack:
    rooms:
      secure: RSsVQ8K9Y4uK+qPyKMqS58GcaTZ72wxJ1PQ2kALbyAUoF63N47gDKrCwyC44tt2aNoH/qfUuSPjopb/ken398GSEFL3KcQ7mhmn0xKwG60XEb0mJjpLbbVeaR51EwAl7SwjXnAKa5LG6nLZQLb1pOCM3sgvbKi+WOuW5Q49TrEQnqzNNWrc34wH7O23zMNt6+BbAlwtLOX28BQa7TmYvier1CR764jVk8rFxbCwGD10ZAt69iaKEWHVAlK2oyj79W0MmfydayHz93zR3aPBWoksdw5B5vHaj6pwQLRVilYIQlIWxQWJSnp+bdC14GvruQY9U1YD1fy4RdLl3RI0iuwKxUGzPxZJY73OpMXIWOq0Inxb+6i4mECWVuLf8q3y16zXjefSj1Er5h2bkhDeOv8tK6IUoGsWIAfRgAlbA2qq1kS7BCQcOAG/UJoL0FSDH2Pl6stoQTcJNkFh2xFc4yuga/RPL4QBgSFRlWzdPKmlY62KZXc8U19yDdVufEnlmsjqXjKBwo/v6XhPd1fCDNzNz/v09yUTJRx12qQyYk6wA12XO2mbXU00lbX65k8psMhh3tlfIxxPiTxpr2tXrrbXVahx0+zFS/v97Ke7M7SKGSQc0ClwtX3Q614RMQAPgtxs9qgaumxRMFkKBIrLoldgwKmYKIZh3vimVesTTbWw=